## 迷宫挑战

#### 功能需求：

1. 根据配置表生成小地图和牌阵。
2. 牌阵和小地图从前到后透明度有个变化。
3. 牌阵应该自适应到屏幕中央，便于对每排个数扩展。显示的牌阵深度有限制，避免一股脑全部显示出来。默认显示5排。
4. 小地图更新，能显示人物位置。
5. 选择卡片时动画：卡片特效回馈、一排消散特效、牌阵前移、小地图更新。
6. 在创建大范围迷宫时，只显示视野中的牌阵，并随着玩家选择更新视野中的卡牌。
7. 卡牌主要分为两种：功能卡，普通卡。
8. 每次迷宫战斗不继承上一次战斗余血，战斗失败即退出迷宫。



   **注意事项**

   1. 领取过的宝箱不能再领取
   2. 打过的小怪不能再打
   3. 战斗时可选择逃回迷宫且不算做战斗失败
   4. 开启连续挑战功能后，不能进入迷宫，同时迷宫奖励不可得
   5. 退出迷宫后必须重新走迷宫

#### 数据表表项：

配置

卡片类型：空地0，障碍1，小路2，怪物3，宝箱4，陷阱5，Boss6

迷宫表：牌阵配置、宝箱奖励、小怪配置、小怪奖励、Boss配置、Boss奖励

#### 实现

**1. 模型层、视图层实现**

卡片

- 展示图案
- 点击回馈 - 粒子+shader  
- 翻转效果 - 协程+回调
- 卡片功能 - 多态

卡片数据

- 迷宫ID、类型
- 路径
- 奖励

**3. 控制层实现**

迷宫系统控制

- 牌阵创建
- 牌阵更新
- 牌阵移动
- 无路判断
- 自动对齐
- 用户操作
- 状态保存

迷宫战斗

- 路点设置与寻路
- 角色生成与销毁
- 结算
- 角色战斗

**4. 服务器端实现**

- 记录宝箱领取状态
- 返回宝箱奖励
- 记录小怪清除状态
- 记录挑战状态

**5. 特效实现**

- 卡片消融特效
- 卡牌炸裂拟态
- 交互反馈（震动、放大消失、旋转）
- 宝箱闪卡特效
- 迷宫迷雾

#### 性能部分：

1. 设计对象池，实例化一次，牌阵更新都从池中取再SetParent和赋值。
2. 流量问题：缓存服务器返回的需要重复使用的数据，避免重复询问。
3. 卡牌图片配置面板注意点：mipmap、A通道、压缩
4. 粒子特效注意控制粒子数



