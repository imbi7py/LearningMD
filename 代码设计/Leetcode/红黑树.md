## 二叉搜索树

红黑树是二叉搜索树的一种，所以我们要先了解二叉搜索树。

#### 特点

1. 某节点的左子树节点值仅包含小于该节点值
2. 某节点的右子树节点值仅包含大于该节点值
3. 左右子树每个也必须是二叉查找树

结合上述特点以及二叉树的中序遍历我们能够得到一个递增的数组。

### 搜索

二叉树的搜索比较方便

1. 如果目标值等于节点的值，则返回节点;
2. 如果目标值小于节点的值，则继续在左子树中搜索;
3. 如果目标值大于节点的值，则继续在右子树中搜索。

### 插入

1. 根据节点值与目标节点值的关系，搜索左子树或右子树；
2. 重复步骤 1 直到到达外部节点；
3. 根据节点的值与目标节点的值的关系，将新节点添加为其左侧或右侧的子节点。

### 删除

1. 如果 key > root.val，说明要删除的节点在右子树，root.right = deleteNode(root.right, key)。
2. 如果 key < root.val，说明要删除的节点在左子树，root.left = deleteNode(root.left, key)。
3. 如果 key == root.val，则该节点就是我们要删除的节点，则：
   	- 如果该节点是叶子节点，则直接删除它：root = null。
      	- 如果该节点不是叶子节点且有右节点，则用它的后继节点的值替代 root.val = successor.val，然后删除后继节点。
         	- 如果该节点不是叶子节点且只有左节点，则用它的前驱节点的值替代 root.val = predecessor.val，然后删除前驱节点。

### 优点小结

二叉搜索树的有优点是，即便在最坏的情况下，也允许你在`O(h)`的时间复杂度内执行所有的搜索、插入、删除操作。当树完全平衡时，时间复杂度最优为O(logH);

空间复杂度为：O(*H*)，递归时堆栈使用的空间，*H* 是树的高度。

通常来说，如果你想有序地存储数据或者需要同时执行搜索、插入、删除等多步操作，二叉搜索树这个数据结构是一个很好的选择。

### 缺点

当BST结构不平衡时，极端情况下会退化成单链表。这时候，BST的方便搜索的优点就不复存在了。

## 红黑树

红黑树是一棵自平衡的BST，它最大的特点时可以旋转树结构，尽量保证平衡性。

### 规则

1. 每个节点是红色或黑色
2. 树的根始终是黑色的 (黑土地孕育黑树根， )
3. 红色节点不能相临（红色节点不能有红色父节点或红色子节点，**并没有说不能出现连续的黑色节点**）
4. 从节点（包括根）到其任何后代NULL节点(叶子结点下方挂的两个空节点，并且认为他们是黑色的)的每条路径都具有相同数量的黑色节点

### 两大核心

1） recolor

1. **将新插入的节点标记为红色**
2. 如果 X 是根结点(root)，则标记为黑色
3. 如果 X 的 parent 不是黑色，同时 X 也不是 root:

- 3.1 如果 X 的 uncle (父节点的兄弟节点) 是红色：

- - 3.1.1 将 parent 和 uncle 标记为黑色
  - 3.1.2 将 grand parent (祖父) 标记为红色
  - 3.1.3 让 X 节点的颜色与 X 祖父的颜色相同，然后重复步骤 2、3

![](https://pic4.zhimg.com/v2-1d35b926316397d82c267593042f8c3f_r.jpg)

2） rotation

当上述3.1不成立时，就需要旋转以维持树的平衡。

具体由4种情况：

- 1 左左 (P 是 G 的左孩子，并且 X 是 P 的左孩子)
- 2 左右 (P 是 G 的左孩子，并且 X 是 P 的右孩子)
- 3 右右 (和 3.2.1 镜像过来，恰好相反)
- 4 右左 (和 3.2.2 镜像过来，恰好相反)

![1](https://pic1.zhimg.com/80/v2-9e139a0f8b4a5e00ca8e643e2130403c_720w.jpg)

![2](https://pic4.zhimg.com/80/v2-3fb33fbb3a42e34ed8a058a047a44cc3_720w.jpg)

![3](https://pic4.zhimg.com/80/v2-62a42ada09cb4547191aa4b9051c7c23_720w.jpg)

![](https://pic4.zhimg.com/80/v2-210d1400ea1b098dfe1582589a6064c3_720w.jpg)