<!DOCTYPE html>
<!-- saved from url=(0057)http://buildnewgames.com/broad-phase-collision-detection/ -->
<html lang="zh-CN" class="article translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style class="darkreader darkreader--fallback" media="screen"></style><style class="darkreader darkreader--text" media="screen"></style><style class="darkreader darkreader--invert" media="screen"></style><style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}</style><style class="darkreader darkreader--user-agent" media="screen">html {
    background-color: #181a1b !important;
}
html, body, input, textarea, select, button {
    background-color: #181a1b;
}
html, body, input, textarea, select, button {
    border-color: #575757;
    color: #e8e6e3;
}
a {
    color: #3391ff;
}
table {
    border-color: #4c4c4c;
}
::placeholder {
    color: #bab5ab;
}
::selection {
    background-color: #005ccc;
    color: #ffffff;
}
::-moz-selection {
    background-color: #005ccc;
    color: #ffffff;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #545b00 !important;
    color: #e8e6e3 !important;
}
::-webkit-scrollbar {
    background-color: #1c1e1f;
    color: #c5c1b9;
}
::-webkit-scrollbar-thumb {
    background-color: #2a2c2e;
}
::-webkit-scrollbar-thumb:hover {
    background-color: #323537;
}
::-webkit-scrollbar-thumb:active {
    background-color: #3d4043;
}
::-webkit-scrollbar-corner {
    background-color: #181a1b;
}
* {
    scrollbar-color: #2a2c2e #1c1e1f;
}</style>
  
  <title>Broad Phase Collision Detection Using Spatial Partitioning - Build New Games</title>
  <meta name="author" content="Bocoup">
  
  <meta name="description" content="Broad Phase Collision Detection Using Spatial Partitioning Oct 8th, 2012 | by Andrew Petersen Collision detection is an ongoing source of research …">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  
  
  <link rel="canonical" href="http://buildnewgames.com/broad-phase-collision-detection">
  <link href="http://buildnewgames.com/favicon.png" rel="icon">

  <link href="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/reset.css" media="screen, projection" rel="stylesheet" type="text/css"><style class="darkreader darkreader--sync" media="screen"></style>

  <link rel="stylesheet" href="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/factory.css">

  <!--[if (gt IE 8)|!(IE)]><!-->
    <link href="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/fonts.css" media="screen, projection" rel="stylesheet" type="text/css"><style class="darkreader darkreader--sync" media="screen"></style>
  <!--<![endif]-->
  <link href="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/base.css" media="screen, projection" rel="stylesheet" type="text/css"><style class="darkreader darkreader--sync" media="screen"></style>
  
  <!-- 
  <link href="/assets/css/screen-small.css" media="screen and (max-width: 480px)" rel="stylesheet" type="text/css">
  <link href="/assets/css/screen-medium.css" media="screen and (min-width: 481px)" rel="stylesheet" type="text/css">
  <link href="/assets/css/screen-large.css" media="screen and (min-width: 1024px)" rel="stylesheet" type="text/css">
  <link href="/assets/css/screen-horizontally-small.css" rel="stylesheet" type="text/css">
   -->
  <link href="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/screen-medium.css" rel="stylesheet" type="text/css"><style class="darkreader darkreader--sync" media="screen"></style>

  <link href="http://buildnewgames.com/atom.xml" rel="alternate" title="Build New Games" type="application/atom+xml">

  <!--[if lt IE 9]>
    <script src="/js/lib/respond.min.js"></script>
  <![endif]-->
<style class="darkreader darkreader--override" media="screen">.jfk-bubble {
    background-color: #000000 !important;
}
.vimvixen-hint {
    background-color: #7b5300 !important;
    border-color: #d8b013 !important;
    color: #f3e8c8 !important;
}</style><script type="text/javascript" async="" src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/ga.js.下载"></script><script type="text/javascript" async="" src="https://apis.google.com/js/plusone.js"></script><script id="facebook-jssdk" src="http://connect.facebook.net/en_US/all.js#appId=212934732101925&amp;xfbml=1"></script><script type="text/javascript" async="" src="http://buildnewgames.disqus.com/embed.js"></script><script type="text/javascript" async="" src="http://platform.twitter.com/widgets.js"></script><link type="text/css" rel="stylesheet" charset="UTF-8" href="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/translateelement.css"><style class="darkreader darkreader--cors" media="screen">.goog-te-banner-frame{left:0px;top:0px;height:39px;width:100%;z-index:10000001;position:fixed;border:none;border-bottom:1px solid #6b90da;margin:0;-moz-box-shadow:0 0 8px 1px #999999;-webkit-box-shadow:0 0 8px 1px #999999;box-shadow:0 0 8px 1px #999999;_position:absolute}.goog-te-menu-frame{z-index:10000002;position:fixed;border:none;-moz-box-shadow:0 3px 8px 2px #999999;-webkit-box-shadow:0 3px 8px 2px #999999;box-shadow:0 3px 8px 2px #999999;_position:absolute}.goog-te-ftab-frame{z-index:10000000;border:none;margin:0}.goog-te-gadget{font-family:arial;font-size:11px;color:#666;white-space:nowrap}.goog-te-gadget img{vertical-align:middle;border:none}.goog-te-gadget-simple{background-color:#fff;border-left:1px solid #d5d5d5;border-top:1px solid #9b9b9b;border-bottom:1px solid #e8e8e8;border-right:1px solid #d5d5d5;font-size:10pt;display:inline-block;padding-top:1px;padding-bottom:2px;cursor:pointer;zoom:1;*display:inline}.goog-te-gadget-icon{margin-left:2px;margin-right:2px;width:19px;height:19px;border:none;vertical-align:middle}.goog-te-combo{margin-left:4px;margin-right:4px;vertical-align:baseline;*vertical-align:middle}.goog-te-gadget .goog-te-combo{margin:4px 0}.goog-logo-link,.goog-logo-link:link,.goog-logo-link:visited,.goog-logo-link:hover,.goog-logo-link:active{font-size:12px;font-weight:bold;color:#444;text-decoration:none}.goog-te-banner .goog-logo-link,.goog-close-link{display:block;margin:0px 10px}.goog-te-banner .goog-logo-link{padding-top:2px;padding-left:4px}.goog-te-combo,.goog-te-banner *,.goog-te-ftab *,.goog-te-menu *,.goog-te-menu2 *,.goog-te-balloon *{font-family:arial;font-size:10pt}.goog-te-banner{margin:0;background-color:#e4effb;overflow:hidden}.goog-te-banner img{border:none}.goog-te-banner-content{color:#000}.goog-te-banner-content img{vertical-align:middle}.goog-te-banner-info{color:#666;vertical-align:top;margin-top:0px;font-size:7pt}.goog-te-banner-margin{width:8px}.goog-te-button{border-color:#e7e7e7;border-style:none solid solid none;border-width:0 1px 1px 0}.goog-te-button div{border-color:#cccccc #999999 #999999 #cccccc;border-right:1px solid #999999;border-style:solid;border-width:1px;height:20px}.goog-te-button button{background:transparent;border:none;cursor:pointer;height:20px;overflow:hidden;margin:0;vertical-align:top;white-space:nowrap}.goog-te-button button:active{background:none repeat scroll 0 0 #cccccc}.goog-te-ftab{margin:0px;background-color:#fff;white-space:nowrap}.goog-te-ftab-link{text-decoration:none;font-weight:bold;font-size:10pt;border:1px outset #888;padding:6px 10px;white-space:nowrap;position:absolute;left:0px;top:0px}.goog-te-ftab-link img{margin-left:2px;margin-right:2px;width:19px;height:19px;border:none;vertical-align:middle}.goog-te-ftab-link span{text-decoration:underline;margin-left:2px;margin-right:2px;vertical-align:middle}.goog-float-top .goog-te-ftab-link{padding:2px 2px;border-top-width:0px}.goog-float-bottom .goog-te-ftab-link{padding:2px 2px;border-bottom-width:0px}.goog-te-menu-value{text-decoration:none;color:#0000cc;white-space:nowrap;margin-left:4px;margin-right:4px}.goog-te-menu-value span{text-decoration:underline}.goog-te-menu-value img{margin-left:2px;margin-right:2px}.goog-te-gadget-simple .goog-te-menu-value{color:#000}.goog-te-gadget-simple .goog-te-menu-value span{text-decoration:none}.goog-te-menu{background-color:#ffffff;text-decoration:none;border:2px solid #c3d9ff;overflow-y:scroll;overflow-x:hidden;position:absolute;left:0;top:0}.goog-te-menu-item{padding:3px;text-decoration:none}.goog-te-menu-item,.goog-te-menu-item:link{color:#0000cc;background:#ffffff}.goog-te-menu-item:visited{color:#551a8b}.goog-te-menu-item:hover{background:#c3d9ff}.goog-te-menu-item:active{color:#0000cc}.goog-te-menu2{background-color:#ffffff;text-decoration:none;border:1px solid #6b90da;overflow:hidden;padding:4px}.goog-te-menu2-colpad{width:16px}.goog-te-menu2-separator{margin:6px 0;height:1px;background-color:#aaa;overflow:hidden}.goog-te-menu2-item div,.goog-te-menu2-item-selected div{padding:4px}.goog-te-menu2-item .indicator{display:none}.goog-te-menu2-item-selected .indicator{display:auto}.goog-te-menu2-item-selected .text{padding-left:4px;padding-right:4px}.goog-te-menu2-item,.goog-te-menu2-item-selected{text-decoration:none}.goog-te-menu2-item div,.goog-te-menu2-item:link div,.goog-te-menu2-item:visited div,.goog-te-menu2-item:active div{color:#0000cc;background:#ffffff}.goog-te-menu2-item:hover div{color:#ffffff;background:#3366cc}.goog-te-menu2-item-selected div,.goog-te-menu2-item-selected:link div,.goog-te-menu2-item-selected:visited div,.goog-te-menu2-item-selected:hover div,.goog-te-menu2-item-selected:active div{color:#000;font-weight:bold}.goog-te-balloon{background-color:#ffffff;overflow:hidden;padding:8px;border:none;-moz-border-radius:10px;border-radius:10px}.goog-te-balloon-frame{background-color:#ffffff;border:1px solid #6b90da;-moz-box-shadow:0 3px 8px 2px #999999;-webkit-box-shadow:0 3px 8px 2px #999999;box-shadow:0 3px 8px 2px #999999;-moz-border-radius:8px;border-radius:8px}.goog-te-balloon img{border:none}.goog-te-balloon-text{margin-top:6px}.goog-te-balloon-zippy{margin-top:6px;white-space:nowrap}.goog-te-balloon-zippy *{vertical-align:middle}.goog-te-balloon-zippy .minus{background-image:url("http://www.google.com/images/zippy_minus_sm.gif")}.goog-te-balloon-zippy .plus{background-image:url("http://www.google.com/images/zippy_plus_sm.gif")}.goog-te-balloon-zippy span{color:#00c;text-decoration:underline;cursor:pointer;margin:0 4px}.goog-te-balloon-form{margin:6px 0 0 0}.goog-te-balloon-form form{margin:0}.goog-te-balloon-form form textarea{margin-bottom:4px;width:100%}.goog-te-balloon-footer{margin:6px 0 4px 0}.goog-te-spinner-pos{z-index:1000;position:fixed;transition-delay:0.6s;left:-1000px;top:-1000px}.goog-te-spinner-animation{background:#ccc;display:flex;align-items:center;justify-content:center;width:104px;height:104px;border-radius:50px;background:#fff url("http://www.gstatic.com/images/branding/product/2x/translate_24dp.png") 50% 50% no-repeat;transition:all 0.6s ease-in-out;transform:scale(0.4);opacity:0}.goog-te-spinner-animation-show{transform:scale(0.5);opacity:1}.goog-te-spinner{margin:2px 0 0 2px;animation:goog-te-spinner-rotator 1.4s linear infinite}@keyframes goog-te-spinner-rotator{0%{transform:rotate(0deg)}100%{transform:rotate(270deg)}}.goog-te-spinner-path{stroke-dasharray:187;stroke-dashoffset:0;stroke:#4285f4;transform-origin:center;animation:goog-te-spinner-dash 1.4s ease-in-out infinite}@keyframes goog-te-spinner-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;transform:rotate(135deg)}100%{stroke-dashoffset:187;transform:rotate(450deg)}}#goog-gt-tt html,#goog-gt-tt body,#goog-gt-tt div,#goog-gt-tt span,#goog-gt-tt iframe,#goog-gt-tt h1,#goog-gt-tt h2,#goog-gt-tt h3,#goog-gt-tt h4,#goog-gt-tt h5,#goog-gt-tt h6,#goog-gt-tt p,#goog-gt-tt a,#goog-gt-tt img,#goog-gt-tt ol,#goog-gt-tt ul,#goog-gt-tt li,#goog-gt-tt table,#goog-gt-tt form,#goog-gt-tt tbody,#goog-gt-tt tr,#goog-gt-tt td{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;text-align:left;line-height:normal}#goog-gt-tt ol,#goog-gt-tt ul{list-style:none}#goog-gt-tt table{border-collapse:collapse;border-spacing:0}#goog-gt-tt caption,#goog-gt-tt th,#goog-gt-tt td{text-align:left;font-weight:normal}#goog-gt-tt input::-moz-focus-inner{border:0}div#goog-gt-tt{padding:10px 14px}#goog-gt-tt{color:#222;background-color:#ffffff;border:1px solid #eee;box-shadow:0 4px 16px rgba(0,0,0,.2);-moz-box-shadow:0 4px 16px rgba(0,0,0,.2);-webkit-box-shadow:0 4px 16px rgba(0,0,0,.2);display:none;font-family:arial;font-size:10pt;width:420px;padding:12px;position:absolute;z-index:10000}#goog-gt-tt .original-text,.gt-hl-layer{clear:both;font-size:10pt;position:relative;text-align:justify;width:100%}#goog-gt-tt .title{color:#999;font-family:arial,sans-serif;margin:4px 0;text-align:left}#goog-gt-tt .close-button{display:none}#goog-gt-tt .logo{float:left;margin:0px}#goog-gt-tt .activity-links{display:inline-block}#goog-gt-tt .started-activity-container{display:none;width:100%}#goog-gt-tt .activity-root{margin-top:20px}#goog-gt-tt .left{float:left}#goog-gt-tt .right{float:right}#goog-gt-tt .bottom{min-height:15px;position:relative;height:1%}#goog-gt-tt .status-message{background:-moz-linear-gradient(top,#29910d 0%,#20af0e 100%);background:-webkit-linear-gradient(top,#29910d 0%,#20af0e 100%);background:-o-linear-gradient(top,#29910d 0%,#20af0e 100%);background:-ms-linear-gradient(top,#29910d 0%,#20af0e 100%);background:linear-gradient(top,#29910d 0%,#20af0e 100%);background:#29910d;border-radius:4px;-moz-border-radius:4px;-webkit-border-radius:4px;box-shadow:inset 0px 2px 2px #1e6609;-moz-box-shadow:inset 0px 2px 2px #1e6609;-webkit-box-shadow:inset 0px 2px 2px #1e6609;color:white;font-size:9pt;font-weight:bolder;margin-top:12px;padding:6px;text-shadow:1px 1px 1px #1e6609}#goog-gt-tt .activity-link{color:#1155cc;cursor:pointer;font-family:arial;font-size:11px;margin-right:15px;text-decoration:none}#goog-gt-tt textarea{font-family:arial;resize:vertical;width:100%;margin-bottom:10px;-webkit-border-radius:1px;-moz-border-radius:1px;border-radius:1px;border:1px solid #d9d9d9;border-top:1px solid silver;font-size:13px;height:auto;overflow-y:auto;padding:1px}#goog-gt-tt textarea:focus{-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,0.3);-moz-box-shadow:inset 0 1px 2px rgba(0,0,0,0.3);box-shadow:inset 0 1px 2px rgba(0,0,0,0.3);border:1px solid #4d90fe;outline:none}#goog-gt-tt .activity-cancel{margin-right:10px}#goog-gt-tt .translate-form{min-height:25px;vertical-align:middle;padding-top:8px}#goog-gt-tt .translate-form .activity-form{margin-bottom:5px;margin-bottom:0px}#goog-gt-tt .translate-form .activity-form input{display:inline-block;min-width:54px;*min-width:70px;border:1px solid #dcdcdc;border:1px solid rgba(0,0,0,0.1);text-align:center;color:#444;font-size:11px;font-weight:bold;height:27px;outline:0;padding:0 8px;vertical-align:middle;line-height:27px;margin:0 16px 0 0;box-shadow:0 1px 2px rgba(0,0,0,.1);-moz-box-shadow:0 1px 2px rgba(0,0,0,.1);-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-webkit-transition:all 0.218s;-moz-transition:all 0.218s;-o-transition:all 0.218s;transition:all 0.218s;background-color:#f5f5f5;background-image:-webkit-gradient(linear,left top,left bottom,from(#f5f5f5),to(#f1f1f1));background-image:-webkit-linear-gradient(top,#f5f5f5,#f1f1f1);background-image:-moz-linear-gradient(top,#f5f5f5,#f1f1f1);background-image:-ms-linear-gradient(top,#f5f5f5,#f1f1f1);background-image:-o-linear-gradient(top,#f5f5f5,#f1f1f1);background-image:linear-gradient(top,#f5f5f5,#f1f1f1);-webkit-user-select:none;-moz-user-select:none;cursor:default}#goog-gt-tt .translate-form .activity-form input:hover{border:1px solid #c6c6c6;color:#222;-webkit-transition:all 0.0s;-moz-transition:all 0.0s;-o-transition:all 0.0s;transition:all 0.0s;background-color:#f8f8f8;background-image:-webkit-gradient(linear,left top,left bottom,from(#f8f8f8),to(#f1f1f1));background-image:-webkit-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-moz-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-ms-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-o-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:linear-gradient(top,#f8f8f8,#f1f1f1)}#goog-gt-tt .translate-form .activity-form input:active{border:1px solid #c6c6c6;color:#333;background-color:#f6f6f6;background-image:-webkit-gradient(linear,left top,left bottom,from(#f6f6f6),to(#f1f1f1));background-image:-webkit-linear-gradient(top,#f6f6f6,#f1f1f1);background-image:-moz-linear-gradient(top,#f6f6f6,#f1f1f1);background-image:-ms-linear-gradient(top,#f6f6f6,#f1f1f1);background-image:-o-linear-gradient(top,#f6f6f6,#f1f1f1);background-image:linear-gradient(top,#f6f6f6,#f1f1f1)}#goog-gt-tt .translate-form .activity-form input:focus #goog-gt-tt .translate-form .activity-form input.focus #goog-gt-tt .translate-form .activity-form input:active,#goog-gt-tt .translate-form .activity-form input:focus:active,#goog-gt-tt .translate-form .activity-form input:.focus:active{box-shadow:inset 0 0 0 1px rgba(255,255,255,0.5);-webkit-box-shadow:inset 0 0 0 1px rgba(255,255,255,0.5);-moz-box-shadow:inset 0 0 0 1px rgba(255,255,255,0.5)}#goog-gt-tt .translate-form .activity-form input:focus,#goog-gt-tt .translate-form .activity-form input.focus{outline:none;border:1px solid #4d90fe;z-index:4!important}#goog-gt-tt .translate-form .activity-form input.selected{background-color:#eeeeee;background-image:-webkit-gradient(linear,left top,left bottom,from(#eeeeee),to(#e0e0e0));background-image:-webkit-linear-gradient(top,#eeeeee,#e0e0e0);background-image:-moz-linear-gradient(top,#eeeeee,#e0e0e0);background-image:-ms-linear-gradient(top,#eeeeee,#e0e0e0);background-image:-o-linear-gradient(top,#eeeeee,#e0e0e0);background-image:linear-gradient(top,#eeeeee,#e0e0e0);-webkit-box-shadow:inset 0px 1px 2px rgba(0,0,0,0.1);-moz-box-shadow:inset 0px 1px 2px rgba(0,0,0,0.1);box-shadow:inset 0px 1px 2px rgba(0,0,0,0.1);border:1px solid #ccc;color:#333}#goog-gt-tt .translate-form .activity-form input.activity-submit{color:white;border-color:#3079ed;background-color:#4d90fe;background-image:-webkit-gradient(linear,left top,left bottom,from(#4d90fe),to(#4787ed));background-image:-webkit-linear-gradient(top,#4d90fe,#4787ed);background-image:-moz-linear-gradient(top,#4d90fe,#4787ed);background-image:-ms-linear-gradient(top,#4d90fe,#4787ed);background-image:-o-linear-gradient(top,#4d90fe,#4787ed);background-image:linear-gradient(top,#4d90fe,#4787ed)}#goog-gt-tt .translate-form .activity-form input.activity-submit:hover #goog-gt-tt .translate-form .activity-form input.activity-submit:focus,#goog-gt-tt .translate-form .activity-form input.activity-submit.focus #goog-gt-tt .translate-form .activity-form input.activity-submit:active{border-color:#3079ed;background-color:#357ae8;background-image:-webkit-gradient(linear,left top,left bottom,from(#4d90fe),to(#357ae8));background-image:-webkit-linear-gradient(top,#4d90fe,#357ae8);background-image:-moz-linear-gradient(top,#4d90fe,#357ae8);background-image:-ms-linear-gradient(top,#4d90fe,#357ae8);background-image:-o-linear-gradient(top,#4d90fe,#357ae8);background-image:linear-gradient(top,#4d90fe,#357ae8)}#goog-gt-tt .translate-form .activity-form input.activity-submit:hover{box-shadow:inset 0 0 0 1px #fff,0px 1px 1px rgba(0,0,0,0.1);-webkit-box-shadow:inset 0 0 0 1px #fff,0px 1px 1px rgba(0,0,0,0.1);-moz-box-shadow:inset 0 0 0 1px #fff,0px 1px 1px rgba(0,0,0,0.1)}#goog-gt-tt .translate-form .activity-form input:focus,#goog-gt-tt .translate-form .activity-form input.focus,#goog-gt-tt .translate-form .activity-form input:active,#goog-gt-tt .translate-form .activity-form input:hover,#goog-gt-tt .translate-form .activity-form input.activity-submit:focus,#goog-gt-tt .translate-form .activity-form input.activity-submit.focus,#goog-gt-tt .translate-form .activity-form input.activity-submit:active,#goog-gt-tt .translate-form .activity-form input.activity-submit:hover{border-color:#3079ed}#goog-gt-tt .gray{color:#999;font-family:arial,sans-serif}#goog-gt-tt .alt-helper-text{color:#999;font-size:11px;font-family:arial,sans-serif;margin:15px 0px 5px 0px}#goog-gt-tt .alt-error-text{color:#800;display:none;font-size:9pt}.goog-text-highlight{background-color:#c9d7f1;-webkit-box-shadow:2px 2px 4px #9999aa;-moz-box-shadow:2px 2px 4px #9999aa;box-shadow:2px 2px 4px #9999aa;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;position:relative}#goog-gt-tt .alt-menu.goog-menu{background:#ffffff;border:1px solid #dddddd;-webkit-box-shadow:0px 3px 3px #888;-moz-box-shadow:0px 2px 20px #888;box-shadow:0px 2px 4px #99a;min-width:0;outline:none;padding:0;position:absolute;z-index:2000}#goog-gt-tt .alt-menu .goog-menuitem{cursor:pointer;padding:2px 5px 5px;margin-right:0px;border-style:none}#goog-gt-tt .alt-menu div.goog-menuitem:hover{background:#ddd}#goog-gt-tt .alt-menu .goog-menuitem h1{font-size:100%;font-weight:bold;margin:4px 0px}#goog-gt-tt .alt-menu .goog-menuitem strong{color:#345aad}#goog-gt-tt .goog-submenu-arrow{text-align:right;position:absolute;right:0;left:auto}#goog-gt-tt .goog-menuitem-rtl .goog-submenu-arrow{text-align:left;position:absolute;left:0;right:auto}#goog-gt-tt .gt-hl-text,#goog-gt-tt .trans-target-highlight{background-color:#f1ea00;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;-moz-box-shadow:rgba(0,0,0,.5) 3px 3px 4px;-webkit-box-shadow:rgba(0,0,0,.5) 3px 3px 4px;box-shadow:rgba(0,0,0,.5) 3px 3px 4px;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;color:#f1ea00;cursor:pointer;margin:-2px -2px -2px -3px;padding:2px 2px 2px 3px;position:relative}#goog-gt-tt .trans-target-highlight{color:#222}#goog-gt-tt .gt-hl-layer{color:white;position:absolute!important}#goog-gt-tt .trans-target,#goog-gt-tt .trans-target .trans-target-highlight{background-color:#c9d7f1;border-radius:4px 4px 0px 0px;-webkit-border-radius:4px 4px 0px 0px;-moz-border-radius:4px 4px 0px 0px;-moz-box-shadow:rgba(0,0,0,.5) 3px 3px 4px;-webkit-box-shadow:rgba(0,0,0,.5) 3px 3px 4px;box-shadow:rgba(0,0,0,.5) 3px 3px 4px;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;cursor:pointer;margin:-2px -2px -2px -3px;padding:2px 2px 3px 3px;position:relative}#goog-gt-tt span:focus{outline:none}#goog-gt-tt .trans-edit{background-color:transparent;border:1px solid #4d90fe;border-radius:0em;-webkit-border-radius:0em;-moz-border-radius:0em;margin:-2px;padding:1px}#goog-gt-tt .gt-trans-highlight-l{border-left:2px solid red;margin-left:-2px}#goog-gt-tt .gt-trans-highlight-r{border-right:2px solid red;margin-right:-2px}#goog-gt-tt #alt-input{padding:2px}#goog-gt-tt #alt-input-text{font-size:11px;padding:2px 2px 3px;margin:0;background-color:#fff;color:#333;border:1px solid #d9d9d9;border-top:1px solid #c0c0c0;display:inline-block;vertical-align:top;height:21px;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-border-radius:1px}#goog-gt-tt #alt-input-text:hover{border:1px solid #b9b9b9;border-top:1px solid #a0a0a0;-webkit-box-shadow:inset 0px 1px 2px rgba(0,0,0,0.1);-moz-box-shadow:inset 0px 1px 2px rgba(0,0,0,0.1);box-shadow:inset 0px 1px 2px rgba(0,0,0,0.1)}#goog-gt-tt #alt-input-text:focus{-webkit-box-shadow:inset 0px 1px 2px rgba(0,0,0,0.3);-moz-box-shadow:inset 0px 1px 2px rgba(0,0,0,0.3);box-shadow:inset 0px 1px 2px rgba(0,0,0,0.3);outline:none;border:1px solid #4d90fe}#goog-gt-tt #alt-input-submit{font-size:11px;padding:2px 6px 3px;margin:0 0 0 2px;height:21px}</style><style class="darkreader darkreader--sync" media="screen"></style></head>


<body class="clearfix ">

  <banner>

    <header id="header">
  
  <a href="http://buildnewgames.com/" class="bng-logo"> 
    <img src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/bng-logo.png" alt="BNG">
  </a>

  <nav class="large-nav">
    <ul>
      <li><a href="http://buildnewgames.com/articles/">Articles</a></li>
      <li><a href="http://buildnewgames.com/authors/">Authors</a></li>
      <li><a href="http://buildnewgames.com/about/">About</a></li>
    </ul>
  </nav>

  <div class="home-page-info">
    <h1><a href="http://buildnewgames.com/">Build New Games</a></h1>
    <p>Open Web techniques for cutting-edge game development</p>
  </div>

</header>

    

  </banner>

  

  

    <aside class="category-list medium">
  <h2>Topics</h2>
  <ul>
    <li><a class="category" href="http://buildnewgames.com/blog/categories/design/">Design</a></li>
    <li><a class="category" href="http://buildnewgames.com/blog/categories/engines/">Engines</a></li>
    <li><a class="category" href="http://buildnewgames.com/blog/categories/graphics/">Graphics</a></li>
    <li><a class="category" href="http://buildnewgames.com/blog/categories/javascript/">JavaScript</a></li>
    <li><a class="category" href="http://buildnewgames.com/blog/categories/mobile/">Mobile</a></li>
    <li><a class="category" href="http://buildnewgames.com/blog/categories/multiplayer/">Multiplayer</a></li>
    <li><a class="category" href="http://buildnewgames.com/blog/categories/platform/">Platform</a></li>
    
  </ul>
  <div class="advertisement">
    <script type="text/javascript"><!--//<![CDATA[
   var m3_u = (location.protocol=='https:'?'https://revive.bocoup.com/www/delivery/ajs.php':'http://revive.bocoup.com/www/delivery/ajs.php');
   var m3_r = Math.floor(Math.random()*99999999999);
   if (!document.MAX_used) document.MAX_used = ',';
   document.write ("<scr"+"ipt type='text/javascript' src='"+m3_u);
   document.write ("?zoneid=6");
   document.write ('&amp;cb=' + m3_r);
   if (document.MAX_used != ',') document.write ("&amp;exclude=" + document.MAX_used);
   document.write (document.charset ? '&amp;charset='+document.charset : (document.characterSet ? '&amp;charset='+document.characterSet : ''));
   document.write ("&amp;loc=" + escape(window.location));
   if (document.referrer) document.write ("&amp;referer=" + escape(document.referrer));
   if (document.context) document.write ("&context=" + escape(document.context));
   if (document.mmm_fo) document.write ("&amp;mmm_fo=1");
   document.write ("'><\/scr"+"ipt>");
//]]>--></script><script type="text/javascript" src="http://revive.bocoup.com/www/delivery/ajs.php?zoneid=6&amp;cb=67544719325&amp;charset=UTF-8&amp;loc=http%3A//buildnewgames.com/broad-phase-collision-detection/&amp;referer=https%3A//gl.duoyioa.com/"></script><noscript><a href='http://revive.bocoup.com/www/delivery/ck.php?n=a23a1951&amp;cb=INSERT_RANDOM_NUMBER_HERE' target='_blank'><img src='http://revive.bocoup.com/www/delivery/avw.php?zoneid=6&amp;cb=INSERT_RANDOM_NUMBER_HERE&amp;n=a23a1951' border='0' alt='' /></a></noscript>
<span class="fine">Ads by <a href="http://bocoup.com/">Bocoup</a></span>

  </div>
</aside>

  


  
    <section id="main" class="article">
      <article>
  
    <header>
      
        <h1 class="entry-title">Broad Phase Collision Detection Using Spatial Partitioning</h1>
      
      
        <p class="meta">
          








  


<time datetime="2012-10-08T12:00:00+00:00" pubdate="" data-updated="true">Oct 8<span>th</span>, 2012</time>
           | by <a href="http://kirbysayshi.com/">Andrew Petersen</a>
        </p>
      
    </header>

  
  
  
    <div class="entry-content"><p>Collision detection is an ongoing source of research and constant optimization in game development. It can be a source of exuberance or nearly infinite frustration. Rolling your own is typically the best way to make sure your game is never finished! However, knowing what an engine does internally to make your life easier is extremely beneficial to you as a developer. In addition to increasing your knowledge and understanding, it also helps you appreciate the hard work wrought by the giants whose shoulders you’re standing on.</p>

<p>This article focuses on two approaches to broad phase detection of collisions. The first is a brute force method that, while simple, quickly becomes wildly inefficient at typical game entity counts. The second is a form of spatial partitioning called a spatial grid. It is relatively simple, yet handles large numbers of game entities efficiently.</p>

<h2 id="what-is-broad-phase-collision-detection">What is Broad-Phase Collision Detection?</h2>

<p>Collision detection is usually performed in two phases: <em>broad phase</em> and <em>narrrow phase</em>.</p>

<p>Broad phase detection is typically a computationally low cost operation that quickly answers the question, “Which objects have a strong possibility of colliding?” Approaches include <a href="http://en.wikipedia.org/wiki/Sweep_and_prune">Sweep and Prune</a>, and <a href="http://en.wikipedia.org/wiki/Space_partitioning">Spatial Partitioning</a>.</p>

<p>Narrow phase is the fine grained, “What part of object A colided with object B?” step. It is typically computationally intense, and thus cannot be performed on every pair of objects in the time between game updates (e.g. the next drawn frame). Examples of narrow phase techniques are the <a href="http://en.wikipedia.org/wiki/Hyperplane_separation_theorem">Hyperplane Separation Theorem</a> (also known as the Separating Axis Theorem) <sup id="fnref:1"><a href="http://buildnewgames.com/broad-phase-collision-detection/#fn:1" class="footnote">1</a></sup>, <a href="http://old.troygilbert.com/2009/08/pixel-perfect-collision-detection-revisited/">Pixel Perfect Collision Detection</a> <sup id="fnref:2"><a href="http://buildnewgames.com/broad-phase-collision-detection/#fn:2" class="footnote">2</a></sup>, and <a href="http://www.gamasutra.com/view/feature/3383/simple_intersection_tests_for_games.php">Swept Tests</a>.</p>

<h2 id="collision-detection-vs-collision-response">Collision Detection vs Collision Response</h2>

<p>There are two phases when attempting to update a game world: <em>detection</em> of the collision, followed by the <em>response</em>, or the result of that collision (e.g. two balls bounce off of each other). This article will focus exclusively on the detection of a collision, not the response.</p>

<h2 id="our-world-and-demos">Our World and Demos</h2>

<p>The same basic setup will be used for each example of collision detection. We have a global namespace, <code>ro</code> (which is also the name of the basic engine), which will contain the following components:</p>

<ul>
  <li><code>ro.World</code>: responsible for adding entities, stepping/updating, and tying everything together.</li>
  <li><code>ro.Entity</code>: a single “thing” that will exist in our game. It has basic properties, like position, size, acceleration, and more.</li>
  <li><code>ro.Screen</code>: responsible for providing a drawing context and drawing management. Simple boxes are all that will be needed to be drawn, but separating out drawing state from the state of the world itself is good practice.</li>
  <li><code>ro.math</code>: some common math utilities, like line intersection.</li>
  <li><code>ro.ov3</code>: vector operations for generic objects with x/y properties</li>
  <li><code>ro.coltech</code>: Short for “collision technique”, this object will hold the constructors for our collision detection interface.</li>
</ul>

<p>Each demo will be using squares, and this is by no accident; most engines use a concept known as an <a href="https://citational.com/v/5p9/axis-aligned-bounding-box">Axis-Aligned Bounding Box</a> (AABB) to simplify and speed up broad phase detection. An AABB is a rectangular approximation for the position and amount of space an entity occupies, and can be used in both 2D and 3D. In this article’s 2D demos, an AABB will be defined by two points: a minimum and maximum. Together, these can be used to extrapolate the remaining two points, but this is usually not necessary. <a href="http://en.wikipedia.org/wiki/Axis-aligned_object">Axis-aligned</a> implies that the sides of the box are parallel to the major axes of the coordinate system, which in the demos are positive X moving right across the screen, and positive Y moving down the screen.</p>

<p><a href="http://jsfiddle.net/">JSFiddle</a> will be used to sandbox the demos. This means that the following will be valid for each demo:</p>

<table>
    <tbody><tr>
        <th>Variable Path</th>
        <th>Instance Type</th>
        <th>Description</th>
    </tr>
    <tr>
        <td><code>bng</code></td>
        <td><code>Object</code></td>
        <td>A namespace for our demo instances</td>
    </tr>
    <tr>
        <td><code>bng.world</code></td>
        <td><code>ro.World</code></td>
        <td>Global reference to the world</td>
    </tr>
    <tr>
        <td><code>bng.world.screen</code></td>
        <td><code>ro.Screen</code></td>
        <td>Global reference to the screen (canvas and canvas 2D context)</td>
    </tr>
    <tr>
        <td><code>ov3</code></td>
        <td><code>Object</code></td>
        <td>References ro.ov3, for vector operations</td>
    </tr>
</tbody></table>

<p>The world also uses the following order for each step of the simulation:</p>

<ul>
  <li>Clear the screen</li>
  <li>Call <code>World.draw</code></li>
  <li>Accelerate all entities, update their AABBs</li>
  <li>Call the collision system’s <code>update</code> method</li>
  <li>Call the collision system’s <code>queryForCollisionPairs</code> method</li>
  <li>Call the user-defined <code>handleCollisions</code></li>
  <li>Apply inertia to all entities <sup id="fnref:3"><a href="http://buildnewgames.com/broad-phase-collision-detection/#fn:3" class="footnote">3</a></sup>, update their AABBs</li>
  <li>Call the user-defined <code>update</code></li>
</ul>

<p>All demos can be stopped/paused and started by mouseover/mouseout.</p>

<p>Let’s get started!</p>

<h2 id="approach-1-brute-force">Approach #1: Brute Force</h2>

<p>In nearly any collision detection scheme, every object must be tested or touched by code at least once. The most simple form is called a brute force test, where every object is uniquely tested (no duplication of tests) for collision with every other object. For games with very few objects, this is more than likely the fastest and simplest method. However, the computational complexity of this method increases quadratically for every object you add:</p>

<div class="bogus-wrapper"><notextile><figure id="fig-1">
    <iframe style="width: 100%; height: 465px" src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/result.html" allowfullscreen="allowfullscreen" frameborder="0">
    </iframe>
    <figcaption>
        Fig. 1: A graph of the number of checks required for brute force collision as the number of entities increases. For only 100 entities, nearly 5000 collision checks are required.
    </figcaption>
</figure></notextile></div>

<p>This quickly becomes the biggest bottleneck of the game. But here’s how to do it anyway! It is often used as an internal component of other broad phase techniques (and will be used in the second approach, the spatial grid), and occasionally is the most appropriate choice for your game.</p>

<p>Brute force is accomplished by a nested loop:</p>

<div class="bogus-wrapper"><notextile><figure id="fig-2">
    <pre><code>
BruteForceTech.prototype.queryForCollisionPairs = function(){

    var i, j, e1, e2, pairs = [], entityLen = this.entities.length;

    this.collisionTests = 0;

    for( i = 0; i &lt; entityLen; i++ ){
        e1 = this.entities[i];

        for( j = i+1; j &lt; entityLen; j++ ){
            e2 = this.entities[j];

            this.collisionTests += 1;

            if( this.aabb2DIntersection(e1, e2) === true ){
                pairs.push( [e1, e2] );
            }
        }
    }

    return pairs;
}

BruteForceTech.prototype.aabb2DIntersection = function( objA, objB ){
    var  a = objA.getAABB()
        ,b = objB.getAABB();

    if(
        a.min[0] &gt; b.max[0] || a.min[1] &gt; b.max[1]
        || a.max[0] &lt; b.min[0] || a.max[1] &lt; b.min[1]
    ){
        return false;
    } else {
        return true;
    }
}
    </code></pre>
    <figcaption>
        Fig. 2: Two functions demonstrating brute force collision detection iteration and an AABB overlap test.
    </figcaption>
</figure></notextile></div>

<p>There is a small trick here to make sure we don’t have to worry about testing objects more than once accidentally. The inner loop always starts at <code>i + 1</code> as opposed to <code>0</code>. This ensures that anything “behind” <code>i</code> is never touched by the inner loop. If this is confusing, the best way to understand is to work through what the loops and variables are doing using pen and paper.</p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该方法还引入了碰撞检测的主要内容：AABB重叠测试。</font><font style="vertical-align: inherit;">如前所述，AABB代表轴对齐的边界框，并且是用作粗略估计实体的位置和大小的框。</font><font style="vertical-align: inherit;">每个条目都</font></font><code>ro.coltech</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要求AABB由具有</font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font><font style="vertical-align: inherit;">的对象组成</font><font style="vertical-align: inherit;">，每个</font><font style="vertical-align: inherit;">对象</font><font style="vertical-align: inherit;">都指向一个至少包含2个数字的数组，表示绝对游戏世界坐标：</font></font></p>

<pre><code>var myAABB = {
    min: [ 10, 20 ], max: [ 20, 30 ]
}
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上面的例子描述了一个位于</font></font><code>10, 20</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，宽度和高度为</font><font style="vertical-align: inherit;">的AABB </font></font><code>10</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">由于AABB </font></font><code>ro</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用绝对坐标，因此只要实体的位置发生变化，就必须更新它们。</font><font style="vertical-align: inherit;">此更新在</font></font><a href="https://github.com/kirbysayshi/broad-phase-bng/blob/master/lib/ro.world.js"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ro.world＃step </font></font></a> <sup id="fnref:4"><a href="http://buildnewgames.com/broad-phase-collision-detection/#fn:4" class="footnote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4中</font></font></a></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自动发生</font><font style="vertical-align: inherit;">。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于框是轴对齐的，因此重叠确定与分别比较每个对象的最小和最大点一样简单</font></font><sup id="fnref:5"><a href="http://buildnewgames.com/broad-phase-collision-detection/#fn:5" class="footnote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></a></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请注意，此测试仅返回布尔值，而不是有关</font><font style="vertical-align: inherit;">它们</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重叠的信息（</font><font style="vertical-align: inherit;">它们</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重叠是窄相位检测的工作）。</font><font style="vertical-align: inherit;">代码包含在</font></font><a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图2中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

<div class="bogus-wrapper"><notextile><figure id="fig-3">
    <iframe style="width: 100%; height: 480px" src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/result(1).html" allowfullscreen="allowfullscreen" frameborder="0">
    </iframe>
    <figcaption><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        图3：蛮力碰撞！</font><font style="vertical-align: inherit;">碰撞的方块较暗。</font><font style="vertical-align: inherit;">单击以添加更多并观看帧速率下降（最终）。</font><font style="vertical-align: inherit;">鼠标悬停开始，mouseout停止。
    </font></font></figcaption>
</figure></notextile></div>

<p><a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">展示了完整的强力技术的结果，并且在视觉上也提供了潜在的优化。</font><font style="vertical-align: inherit;">在此示例中，正在针对所有其他正方形检查所有正方形，但实际上只有一个正方形正在移动。</font><font style="vertical-align: inherit;">优化是构造移动对象列表，然后将它们与所有静态对象进行比较。</font><font style="vertical-align: inherit;">如果这是否合适取决于游戏的机制。</font></font></p>

<h2 id="approach-2-bins--spatial-partioning--simple-spatial-grid"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法＃2：箱/空间分区/简单空间网格</font></font></h2>

<p><a href="http://en.wikipedia.org/wiki/Space_partitioning"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于我们的目的，</font><a href="http://en.wikipedia.org/wiki/Space_partitioning"><font style="vertical-align: inherit;">空间分区</font></a><font style="vertical-align: inherit;">是基于一些简单的规则将连续空间划分为若干个离散区域的行为（规则随着空间分割的每种技术而变化）。</font><font style="vertical-align: inherit;">常用技术包括四</font></font><a href="http://en.wikipedia.org/wiki/Quadtree"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">叉树</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="http://en.wikipedia.org/wiki/BSP_tree"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BSP树</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="http://en.wikipedia.org/wiki/R-tree"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R树</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="http://en.wikipedia.org/wiki/Bin_%28computational_geometry%29"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bins</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / Spatial Grids，这是本节的主题。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们的网格系统的规则如下：</font></font></p>

<ul>
  <li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单元被定义为具有离散边界的正方形（例如，它描述了精确的“块”空间）。</font></font><sup id="fnref:6"><a href="http://buildnewgames.com/broad-phase-collision-detection/#fn:6" class="footnote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></a></sup></li>
  <li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果实体的轴对齐边界框与单元格重叠，则实体将插入该单元格中。</font></font></li>
  <li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以将实体插入多个单元格中。</font></font></li>
  <li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每次世界更新后，网格都将被丢弃并重建。</font></font></li>
  <li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">寻找共存对需要迭代网格的每个被占用的单元。</font></font></li>
  <li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们必须跟踪哪些对已经相互测试过。</font></font></li>
</ul>

<h3 id="representing-the-grid"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代表网格</font></font></h3>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间网格具有世界坐标与内存结构的一对一映射，由数组或链表表示。</font><font style="vertical-align: inherit;">直接映射到物理空间允许更容易地可视化空间网格，有助于调试和理解。</font><font style="vertical-align: inherit;">我们的网格将由3D数组表示。</font><font style="vertical-align: inherit;">第一个数组的索引是列，内部数组的索引是单元格，最里面的索引是分配给单元格的单个实体：</font></font></p>

<div class="bogus-wrapper"><notextile><figure id="fig-4">
    <img src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/spatial-grid-array-mapping.png" alt="将空间映射到数组">
    <figcaption><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        图4：一个矩形物体，其左上角位于</font></font><code>{ x: 20, y: 50 }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它与六个网格单元重叠，因此被添加到每个网格单元中。</font><font style="vertical-align: inherit;">虽然字母（A，B等）实际上并未在代码中使用，但它们在此用于减少行和列之间的歧义。</font><font style="vertical-align: inherit;">包含实体左上角的单元格是：</font></font><code>grid[0][B]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，在实际代码中映射到的单元格</font></font><code>grid[0][1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></figcaption>
</figure></notextile></div>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如</font></font><code>{ x: 46, y: 237 }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">映射世界位置</font><font style="vertical-align: inherit;">可以使用以下公式来完成：</font></font></p>

<pre><code>// Math.floor( (position - gridMinimum) / gridCellSize )

var  col = Math.floor( (46 - grid.min.x) / grid.pxCellSize )
    ,cell = Math.floor( (237 - grid.min.y) / grid.pxCellSize );

grid[col][cell] = ... // bucket to put entity into
</code></pre>

<p><code>grid.pxCellSize</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是每个单元格覆盖的像素数。</font><font style="vertical-align: inherit;">由于假设每个单元格是正方形，因此只需要一个值。</font></font><code>grid.min.x/y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许实体具有负位置，并且仍然产生有效的数值数组索引。</font><font style="vertical-align: inherit;">通常情况下，网格最小值是</font></font><code>{ x: 0, y: 0 }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但您可以使用一个网格映射到</font></font><a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-7"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如图5所示</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的世界</font><font style="vertical-align: inherit;">。</font></font></p>

<div class="bogus-wrapper"><notextile><figure id="fig-5">
    <img src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/spatial-grid-offset.png" alt="通过偏移映射到世界的网格">
    <figcaption><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        图5：以灰色定义的网格偏离原点，由具有非零最小属性指定。</font><font style="vertical-align: inherit;">考虑此偏移量允许具有负位置的实体仍然生成有效的数组索引。
    </font></font></figcaption>
</figure></notextile></div>

<h3 id="choosing-an-appropriate-cell-size"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择合适的细胞大小</font></font></h3>

<p>Cell size plays a large role in how efficient the grid can be. In <a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-6">Fig. 6</a>, the effect of a very small cell size is seen when entities are large. Each entity overlaps many cells, and because the spatial grid iterates over cells, and not entities, there is actually more work for it to do than a brute force entity-to-entity comparison.</p>

<p>In <a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-7">Fig. 7</a>, a very large cell size is paired with small entities. In this case, only one cell will need to be visited, but each entity will need to be tested against every other entity, which is, again, the same as a brute force entity-to-entity comparison.</p>

<div class="bogus-wrapper"><notextile><figure id="fig-6">
    <img src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/spatial-grid-cs-too-small.png" alt="A spatial grid with inappropriately large entities for its cell size.">
    <figcaption>
        Fig. 6: A spatial grid with inappropriately large entities for its cell size. The grey area denotes which cells will need to be visited to test for collisions.
    </figcaption>
</figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure id="fig-7">
    <img src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/spatial-grid-cs-too-large.png" alt="A spatial grid with inappropriately small entities for its cell size.">
    <figcaption>
        Fig. 7: A spatial grid with inappropriately small entities for its cell size. The grey area denotes which cells will need to be visited to test for collisions.
    </figcaption>
</figure></notextile></div>

<p>Both <a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-6">Fig. 6</a> and <a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-7">Fig. 7</a> are worst case scenarios: the size of the entities is a complete mismatch for the size of the cells of the grid. Unfortunately, this is one of the downsides of a strict spatial grid: it must be tuned to the entities it will hold. In addition, if there are entities that vary greatly in size, it can be worse than a brute force comparison, as shown in <a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-8">Fig. 8</a>. In this case, there is no appropriate cell size. A smaller cell size would cause too many cell-to-cell comparisons, while a large cell size would cause as many entity-to-entity checks as the brute force method.</p>

<div class="bogus-wrapper"><notextile><figure id="fig-8">
    <img src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/spatial-grid-cs-worst-case.png" alt="A spatial grid with entities that an appropriate cell size cannot be found.">
    <figcaption>
        Fig. 8: A spatial grid with entities for which an appropriate cell size cannot be found. The grey area denotes which cells will need to be visited to test for collisions.
    </figcaption>
</figure></notextile></div>

<p>To demonstrate the effect cell size can have, <a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-9">Fig. 9</a> allows for the cell size to be changed on the fly. In this case, all of the entities are similarly sized, so an efficient cell size can be found.</p>

<div class="bogus-wrapper"><notextile><figure id="fig-9">
    <iframe style="width: 100%; height: 485px" src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/result(2).html" allowfullscreen="allowfullscreen" frameborder="0">
    </iframe>
    <figcaption>
        Fig. 9: Using a spatial grid, the number of collision checks can be reduced. The three buttons change the size of the internal buckets used to group entities. A very small size produces few checks, but potentially many cells to visit. A large size produces many checks, but fewer cells to iterate through. Click to add more entities. Mouseover to start, mouseout to stop.
    </figcaption>
</figure></notextile></div>

<p>In addition to computational power required, another concern is the memory consumption of the number of allocated cells. As the grid gets more and more fine, more memory will be allocated and released after each update, causing garbage collection churn. This can cause noticeable pauses and hiccups. While it’s difficult to track using user-built tools, Chrome’s Memory Profiler can be used to see the effect each cell size has on memory consumption.</p>

<div class="bogus-wrapper"><notextile><figure id="fig-10">
    <img src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/spatial-grid-memory-usage.png" alt="Garbage collection and memory consumption under different cell sizes">
    <figcaption>
        Fig. 10: This graph from the Chrome Developer Tools shows three primary mouse events, which correlate to the mouse activating the demo shown in <a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-9">Fig. 9</a>. The first event is with cell size set to the default. Notice how memory usage initially grows (the demo intialized), but then remains relatively low with even GC churn. The second event denotes a cell size of 1. Notice how memory usage jumps greatly, and is much more spiky (this is more pronounced with a wider graph). This means that more memory is being used, but is also being discarded, causing Chrome to garbage collect more frequently. The final event denotes a cell size of 50, which shows memory usage increasing at a much slower rate, thus needing to be collected more infrequently.
    </figcaption>
</figure></notextile></div>

<h3 id="grid-population">Grid Population</h3>

<p>As said before, the spatial grid is recreated for each world step. This avoids needing to keep track of updating which cells an entity is overlapping once the entity’s position has changed. The general algorithm for constructing and populating the grid is specified in <a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-11">Fig. 11</a>.</p>

<div class="bogus-wrapper"><notextile><figure id="fig-11">
    <code>
        <ul>
            <li>determine grid width and height in number of cells</li>
            <li>determine total number of grid cells (grid width * height)</li>
            <li>create an array having a length equal to the grid width</li>
            <li>for each entity:
                <ul>
                    <li>find which columns and rows the entity overlaps</li>
                    <li>for each column the entity overlaps:
                        <ul>
                            <li>ensure the column contains an array, each index is a cell </li>
                            <li>for each cell in this column that the entity overlaps:
                                <ul>
                                    <li>ensure there is an array to hold entities</li>
                                    <li>insert entity into the array of entities</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
    </code>
    <figcaption>
        Fig. 11: Algorithmic view of the construction and population of the spatial grid. The actual code is defined in <a href="https://github.com/kirbysayshi/broad-phase-bng/blob/master/lib/ro.coltech.spatial-grid.js"><code>lib/ro.coltech.spatial-grid.js</code></a>, in the <code>SpatialGridTech#update</code> method.
    </figcaption>
</figure></notextile></div>

<h3 id="querying-for-collision-pairs">Querying For Collision Pairs</h3>

<p>Querying for collision pairs is relatively straight forward, and involves visiting each occupied cell of the grid, and comparing all objects in that cell with each other. <a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-12">Fig. 12</a> has the full algorithm.</p>

<div class="bogus-wrapper"><notextile><figure id="fig-12">
    <code>
        <ul>
            <li>For each occupied cell in the grid
                <ul>
                    <li>Compare each entity in the cell with every other
                        <ul>
                            <li>Check if this pair has been tested before</li>
                            <li>If not, check this pair, and mark them as tested</li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
    </code>
    <figcaption>
        Fig. 12: Algorithmic view of the querying of the spatial grid. The actual code is defined in <a href="https://github.com/kirbysayshi/broad-phase-bng/blob/master/lib/ro.coltech.spatial-grid.js"><code>lib/ro.coltech.spatial-grid.js</code></a>, in the <code>SpatialGridTech.prototype.queryForCollisionPairs</code> method.
    </figcaption>
</figure></notextile></div>

<p>The only tricky part of the algorithm is making sure that each pair is only tested once. This is easily done by ensuring that each entity has some way to uniquely identify it, aside from a strict object comparison. The easiest way to manage this in the context of a game engine is to assign an internal number to each entity when it is added to the game world, as shown in <a href="http://buildnewgames.com/broad-phase-collision-detection/#fig-13">Fig. 13</a>.</p>

<div class="bogus-wrapper"><notextile><figure id="fig-13">
    <pre><code>
World.prototype.addEntity = function(entity){
    entity._roId = this.uniq++;
    entity.world = this;
    this.entities.push( entity );
    this.broadPhase.addEntity( entity );
}
    </code></pre>
    <figcaption>
        Fig. 13: Adding an entity to the game world attaches a unique id.
    </figcaption>
</figure></notextile></div>

<p>Once we have unique ids, it’s trivial to track which object pairs have been tested. Each pair forms two keys, <code>A:B</code> and <code>B:A</code>. These keys are then set in an object that functions as a cache. If the keys already exist, then there is no need to test a pair.</p>

<div class="bogus-wrapper"><notextile><figure id="fig-14">
    <pre><code>
hashA = entityA._roId + ':' + entityB._roId;
hashB = entityB._roId + ':' + entityA._roId;

if( !checked[hashA] &amp;&amp; !checked[hashB] ){

    // mark this pair as checked
    checked[hashA] = checked[hashB] = true;

    if( this.aabb2DIntersection( entityA, entityB ) ){
        pairs.push( [entityA, entityB] );
    }
}
    </code></pre>
    <div data-ghpath="lib/ro.coltech.spatial-grid.js" data-ghuserrepo="kirbysayshi/broad-phase-bng" data-ghlines="137-154" data-ghtabsize="2"></div>
    <figcaption>
        Fig. 14: Keeping a cache of tested pairs.
    </figcaption>
</figure></notextile></div>

<p>This cache allows the grid to perform well enough even when using a very small cell size. In that case more cache checks will be performed, which are relatively cheap compared to the brute force method that would be required if the cell size were set very large.</p>

<h3 id="problems">Problems</h3>

<p>As stated before, inefficiencies can arise under certain conditions:</p>

<ul>
  <li>Entities that vary greatly in size</li>
  <li>Improperly tuned cell size</li>
</ul>

<p>The simplicity of spatial grids can often outweigh their limitation of needing to be hand-tuned. When entities are relatively close in size, and their possible bounds are well defined, spatial grids can be an excellent choice. However, in any situation where there are many entities that vary greatly in size (many large entities colliding with many small entities), then the simple grid demonstrated here falls down, devolving into nearly a brute force test.</p>

<h3 id="future-expansion">Future Expansion</h3>

<p>There are a few ways to improve this current grid implementation.</p>

<p>One change that is most obvious in practice is the API of the grid itself. In a non-simulation setting, collision queries are usually performed only when needed, and not globally. For example, in your player update logic for a Mario clone, you may want to know if the player is colliding with a powerup. You wouldn’t want <strong>all</strong> of the various objects that are colliding, only the player and the powerups.</p>

<p>One way around this would be to use different grids for different types of tests. For example, a single grid could be used for the player and powerups, while a second grid could be used for the player vs enemies. Another way is to cache the grand, global collision pairs result, and provide another interface. An example could be <code>isColliding( a, b )</code>, which could then loop through (or use some sort of lookup optimization) the cached result, and return true or false.</p>

<p>Another options may be to reduce the amount of discarded arrays by retaining the grid structure, and actually updating entities’ positions in the structure. While this sounds great in practice, it is actually quite difficult to do in linear time. One would have to maintain a list, for each entity, of its grid locations. During the update phase, each entity would need to be removed from cells it was no longer touching, added to new cells, and also updating its list of grid locations. This adds a lot of complexity to a relatively simple idea.</p>

<p>As an alternative, each entity could be limited to a single cell. Then, at query time, the cells that the entity overlaps could be calculated relatively easily, and all the entities contained within could be tested. The cache of checked pairs would still have to be kept. This would greatly simplify the update phase, while increasing the computational cost of the query phase.</p>

<p>An enterprising developer might be thinking, “What about writing code that manages querying and creating grids for objects of varying size?” Definitely attempt the challenge! But this would greatly complicate querying for collision pairs (you would have to traverse a hierarchy of grids), as well as destroy the simplicity of the grid.</p>

<h2 id="closing-thoughts">Closing Thoughts</h2>

<p>There are few reasons to use brute force instead of a spatial grid. At the worst case, the spatial grid will devolve into the same performance as the brute force, but in the best case be <a href="http://jsperf.com/spatial-grid-vs-brute-force">at least 100x faster</a>, usually more.</p>

<p>A situation where a spatial grid would be inappropriate are when memory usage, garbage collection churn, or code size is a concern (such as for a contest). The memory usage of a spatial grid is minimal, but it’s definitely more than the brute force method. The grid is relatively deterministic in its extreme cases, given set variables, such as number of entities, cell size, and grid dimensions.</p>

<p>For example, given a cell size of 15, 100 entities each 10x10, and a grid that is 150x150:</p>

<table>
    <tbody><tr>
        <th>Scenario</th>
        <th>Number of Collision Checks</th>
        <th>Number of Arrays Created</th>
    </tr>
    <tr>
        <td>Each cell completely contains a single entity</td>
        <td>0</td>
        <td>Grid (1) + Columns (10) + (Columns (10) * Cells per Row (10)) = 111</td>
    </tr>
    <tr>
        <td>Every entity is in the same cell</td>
        <td>100 * 100 = 10000</td>
        <td>Grid (1) + Column (1) + Cell (1) = 3</td>
    </tr>
</tbody></table>

<p>Note that in both cases, if the brute force method were used, there would be 10,000 collision checks.</p>

<p>Hopefully you now have a basic understanding of spatial partitioning in terms of collision detection. If not, please give feedback on what could be improved!</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>For a great tutorial and explanation of how the SAT works, including tweakable demos, see <a href="http://www.metanetsoftware.com/technique/tutorialB.html">Metanet</a>. <a href="http://buildnewgames.com/broad-phase-collision-detection/#fnref:1" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:2">
      <p>The term “Pixel Perfect Collision Detection” is very generic, but is an accurate description of the outcome of the technique. Most software implementations test two sprites. Each sprite is converted to a single color (e.g. blue and red), and then copied onto a graphics buffer. If any pixels are purple, the sprites have collided! Certain gaming systems, like the <a href="http://nocash.emubase.de/everynes.htm">NES</a> and <a href="http://excamera.com/sphinx/gameduino/samples/jkcollision/index.html">Gameduino</a> can actually do this calculation <em>in hardware</em>! <a href="http://buildnewgames.com/broad-phase-collision-detection/#fnref:2" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:3">
      <p>Ro uses a technique called verlet integration, as opposed to Euler (pronounced “oiler”) integration. This provides for a more stable update step, and allows us to simply move the entities to a valid position as a collision response. You may notice that the entities do not have a <code>velocity</code> property; verlet integration stores this implicitely, as the difference between <code>pos</code> and <code>ppos</code> (previous position). <a href="http://buildnewgames.com/broad-phase-collision-detection/#fnref:3" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:4">
      <p>AABBs can also be defined as a set of relative coordinates. To transform them to absolute coordinates, they merely need to be added to the current absolute position of the entity. <a href="http://buildnewgames.com/broad-phase-collision-detection/#fnref:4" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:5">
      <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这实际上是</font></font><a href="http://en.wikipedia.org/wiki/Hyperplane_separation_theorem"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">超平面分离定理的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个特例</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它被大大简化，因为分离轴总是平行于X和Y轴。</font><font style="vertical-align: inherit;">该测试实际上预测每个AABB的每个匹配侧的位置。</font><font style="vertical-align: inherit;">这可以被认为是将每个轴的2D框展平为1D。</font><font style="vertical-align: inherit;">如果投影重叠，则有一个交叉点！</font></font><a href="http://buildnewgames.com/broad-phase-collision-detection/#fnref:5" class="reversefootnote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">↩</font></font></a></p>
    </li>
    <li id="fn:6">
      <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间网格不必由方形单元组成。</font><font style="vertical-align: inherit;">如果您的游戏或模拟填充了椭圆形状，则矩形可能更合适，并且不会添加太多代码复杂性。</font></font><a href="http://buildnewgames.com/broad-phase-collision-detection/#fnref:6" class="reversefootnote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">↩</font></font></a></p>
    </li>
  </ol>
</div>
</div>
  
  
  <section class="author-meta">
    <p class="meta">
      
  

<span class="byline author vcard"><font style="vertical-align: inherit;"><span class="fn"><font style="vertical-align: inherit;">Andrew Petersen</font></span><font style="vertical-align: inherit;">发表</font></font><span class="fn"><font style="vertical-align: inherit;"></font></span></span>

      








  


<time datetime="2012-10-08T12:00:00+00:00" pubdate="" data-updated="true"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2012年</font><font style="vertical-align: inherit;">10月8 </font></font><span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日</font></font></span><font style="vertical-align: inherit;"></font></time><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在 

 </font><span class="categories"><a class="category" href="http://buildnewgames.com/blog/categories/engines/"><font style="vertical-align: inherit;">引擎中</font></a></span><font style="vertical-align: inherit;"> 

。
    </font></font><span class="categories">
  
    <a class="category" href="http://buildnewgames.com/blog/categories/engines/"><font style="vertical-align: inherit;"></font></a>
  
</span><font style="vertical-align: inherit;"></font></p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://buildnewgames.com/broad-phase-collision-detection/" data-via="buildnewgames" data-counturl="http://buildnewgames.com/broad-phase-collision-detection/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">鸣叫</font></font></a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="350" data-show-faces="false"></div>
  
  <a href="http://www.reddit.com/submit" onclick="window.location = &#39;http://www.reddit.com/submit?url=&#39; + encodeURIComponent(window.location); return false"> <img src="http://www.reddit.com/static/spreddit7.gif" alt="submit to reddit" border="0"> </a>
  
  <iframe frameborder="no" scrolling="no" height="28px" width="100px" src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/upvote.html">iframes not supported by your browser</iframe>
  
</div>

    
    <!--
      <p>
      
        <a class="basic-alignment left" href="/a-study-in-adaptive-game-design/" title="Previous Post: A Study in Adaptive Game Design">&laquo; A Study in Adaptive Game Design</a>
      
      
        <a class="basic-alignment right" href="/2d-platformer-character-movement/" title="Next Post: Deft and intuitive player character movement in a 2D platformer">Deft and intuitive player character movement in a 2D platformer &raquo;</a>
      
      </p>
    -->
  </section>

  <section id="comments">
    <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">评论</font></font></h3>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

  <aside class="related-articles">

    

    
      
        
      
        
          
            
    <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相关文章</font></font></h2>

    <ul>
          
          <li>
            <a href="http://buildnewgames.com/simulating-natural-systems/"><font style="vertical-align: inherit;"></font></a>
            <font style="vertical-align: inherit;"><span class="byline"><font style="vertical-align: inherit;">Vince Allen </font></span><a href="http://buildnewgames.com/simulating-natural-systems/"><font style="vertical-align: inherit;">在Web浏览器中模拟自然系统</font></a></font><span class="byline"><font style="vertical-align: inherit;"></font></span>
          </li>
        
      
        
      
        
          
          <li>
            <a href="http://buildnewgames.com/vector-field-collision-avoidance/"><font style="vertical-align: inherit;"></font></a>
            <font style="vertical-align: inherit;"><span class="byline"><font style="vertical-align: inherit;">亚历山大·萨瑟兰的</font></span><a href="http://buildnewgames.com/vector-field-collision-avoidance/"><font style="vertical-align: inherit;">矢量场避障</font></a></font><span class="byline"><font style="vertical-align: inherit;"></font></span>
          </li>
        
      
        
          
          <li>
            <a href="http://buildnewgames.com/introduction-to-crafty/"><font style="vertical-align: inherit;"></font></a>
            <font style="vertical-align: inherit;"><span class="byline"><font style="vertical-align: inherit;">Darren Torpey </font></span><a href="http://buildnewgames.com/introduction-to-crafty/"><font style="vertical-align: inherit;">对Crafty游戏引擎的介绍</font></a></font><span class="byline"><font style="vertical-align: inherit;"></font></span>
          </li>
        
      
        
      
        
          
          <li>
            <a href="http://buildnewgames.com/game-engine-comparison/"><font style="vertical-align: inherit;"></font></a>
            <font style="vertical-align: inherit;"><span class="byline"><font style="vertical-align: inherit;">Matt Greer的</font></span><a href="http://buildnewgames.com/game-engine-comparison/"><font style="vertical-align: inherit;">JavaScript游戏引擎比较</font></a></font><span class="byline"><font style="vertical-align: inherit;"></font></span>
          </li>
        
      
        
      
        
          
          <li>
            <a href="http://buildnewgames.com/box2dweb/"><font style="vertical-align: inherit;"></font></a>
            <font style="vertical-align: inherit;"><span class="byline"><font style="vertical-align: inherit;">Pascal Rettig </font></span><a href="http://buildnewgames.com/box2dweb/"><font style="vertical-align: inherit;">用Box2dWeb制作游戏</font></a></font><span class="byline"><font style="vertical-align: inherit;"></font></span>
          </li>
        
      
        
      
        
      
        
      
        
      
        
          
          <li>
            <a href="http://buildnewgames.com/gamephysics/"><font style="vertical-align: inherit;"></font></a>
            <font style="vertical-align: inherit;"><span class="byline"><font style="vertical-align: inherit;">物流</font></span><a href="http://buildnewgames.com/gamephysics/"><font style="vertical-align: inherit;">引擎如何工作</font></a></font><span class="byline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Burak Kanber</font></font></span>
          </li>
        
      
        
          
          <li>
            <a href="http://buildnewgames.com/2d-platformer-character-movement/"><font style="vertical-align: inherit;"></font></a>
            <font style="vertical-align: inherit;"><span class="byline"><font style="vertical-align: inherit;">由Mary Rose Cook设计</font></span><a href="http://buildnewgames.com/2d-platformer-character-movement/"><font style="vertical-align: inherit;">的2D平台游戏中的Deft和直观的玩家角色移动</font></a></font><span class="byline"><font style="vertical-align: inherit;"></font></span>
          </li>
        
      
        
      
        
      
        
      
        
      
        
          
          <li>
            <a href="http://buildnewgames.com/physics-engines-comparison/"><font style="vertical-align: inherit;"></font></a>
            <font style="vertical-align: inherit;"><span class="byline"><font style="vertical-align: inherit;">Chandler Prall的</font></span><a href="http://buildnewgames.com/physics-engines-comparison/"><font style="vertical-align: inherit;">JavaScript物理引擎比较</font></a></font><span class="byline"><font style="vertical-align: inherit;"></font></span>
          </li>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
      
    </ul>
      

    

      
        
          
            
    <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更多东西</font></font></h2>

    <ul>
          
          <li>
            <a href="http://buildnewgames.com/webgl-threejs/"><font style="vertical-align: inherit;"></font></a>
            <font style="vertical-align: inherit;"><span class="byline"><font style="vertical-align: inherit;">用Nikhil Suresh </font></span><a href="http://buildnewgames.com/webgl-threejs/"><font style="vertical-align: inherit;">用Three.js和WebGL创建3D游戏</font></a></font><span class="byline"><font style="vertical-align: inherit;"></font></span>
          </li>
        
      
        
      
        
          
          <li>
            <a href="http://buildnewgames.com/making-games-fun/"><font style="vertical-align: inherit;"></font></a>
            <font style="vertical-align: inherit;"><span class="byline"><font style="vertical-align: inherit;">Burak Kanber </font></span><a href="http://buildnewgames.com/making-games-fun/"><font style="vertical-align: inherit;">让游戏</font></a></font><span class="byline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变得有趣</font></font></span>
          </li>
        
      
        
      
        
      
      
    </ul>
      

    <a href="http://buildnewgames.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">家</font></font></a>
  </aside>
</article>



<script type="text/javascript">
    var disqus_shortname = 'buildnewgames';
    
      
      // var disqus_developer = 1;
      var disqus_identifier = 'http://buildnewgames.com/broad-phase-collision-detection/';
      var disqus_url = 'http://buildnewgames.com/broad-phase-collision-detection/';
      var disqus_script = 'embed.js';
    
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


    </section>
  


  

  <footer class="medium"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    由</font></font><a href="http://bocoup.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bocoup</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编辑和运营</font><font style="vertical-align: inherit;">。
  </font></font></footer>

  <footer class="small">
    <p>
      Edited and operated by <a href="http://bocoup.com/">Bocoup</a>
    </p>
  </footer>

  <script type="text/javascript">

    // GA stuffs
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1464992-54']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./Broad Phase Collision Detection Using Spatial Partitioning - Build New Games_files/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: rgb(204, 204, 204); background-color: rgb(204, 204, 204); height: 1px; border: none; --darkreader-inline-color:#d1cec7; --darkreader-inline-bgcolor:#27292b; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-color="" data-darkreader-inline-bgcolor="" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>



<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30" data-darkreader-inline-fill="" style="--darkreader-inline-fill:none;"></circle></svg></div></div></body></html>